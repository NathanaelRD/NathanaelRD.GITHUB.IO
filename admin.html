<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Administración - Sistema de Control</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="js/auth.js"></script>
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .navbar {
            background: linear-gradient(135deg, #6e8efb, #a777e3);
        }
        .navbar-brand {
            color: white !important;
            font-weight: 600;
        }
        .dashboard-card {
            border: none;
            border-radius: 15px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 20px;
            background: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }
        .card-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: #6e8efb;
        }
        .stats-card {
            background: linear-gradient(135deg, #6e8efb, #a777e3);
            color: white;
        }
        .logout-btn {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }
        .logout-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark mb-4">
        <div class="container">
            <a class="navbar-brand" href="#">
                <img src="ZONA_2.png" alt="Logo" height="40" class="d-inline-block align-text-top me-2">
                Panel de Administración
            </a>
            <div class="ms-auto">
                <a href="#" class="logout-btn" onclick="logout()"><i class="fas fa-sign-out-alt me-2"></i>Cerrar Sesión</a>
            </div>
        </div>
    </nav>

    <div class="container py-4">
        <!-- Sección de Gestión de Usuarios -->
        

        <!-- Modal para Gestión de Usuarios -->
        <div class="modal fade" id="userModal" tabindex="-1" aria-labelledby="userModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="userModalLabel">Gestionar Usuario</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="userForm">
                            <div class="mb-3">
                                <label for="username" class="form-label">Nombre de Usuario</label>
                                <input type="text" class="form-control" id="username" required>
                            </div>
                            <div class="mb-3">
                                <label for="password" class="form-label">Contraseña</label>
                                <input type="password" class="form-control" id="password" required>
                            </div>
                            <div class="mb-3">
                                <label for="role" class="form-label">Rol</label>
                                <select class="form-select" id="role" required>
                                    <option value="admin">Administrador</option>
                                    <option value="dr-aventureros">Director de Aventureros</option>
                                    <option value="dr-conquistador">Director de Conquistadores</option>
                                    <option value="dr-guias">Director de Guías Mayores</option>
                                </select>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                        <button type="button" class="btn btn-primary" onclick="saveUser()">Guardar</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-md-4">
                <div class="card dashboard-card stats-card">
                    <div class="card-body text-center">
                        <h3>Bienvenido</h3>
                        <p id="adminName" class="mb-0">Administrador</p>
                    </div>
                </div>
            </div>
            <div class="col-md-8">
                <div class="card dashboard-card">
                    <div class="card-body">
                        <h5 class="card-title">Resumen del Sistema</h5>
                        <p class="card-text">Accede a todas las secciones del sistema desde este panel de control.</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-4">
                <div class="card dashboard-card h-100">
                    <div class="card-body text-center">
                        <img src="img/aventureros.png" alt="Logo Aventureros" style="width: 150px; height: 150px; object-fit: contain; margin-bottom: 1rem;">
            
                        <h5 class="card-title">Aventureros</h5>
                        <p class="card-text">Gestión del club de Aventureros</p>
                        <a href="Aventureros/index_avent.html" class="btn btn-primary">Acceder</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card dashboard-card h-100">
                    <div class="card-body text-center">
                        <img src="img/conquistador.png" alt="Logo Conquistadores" style="width: 150px; height: 150px; object-fit: contain; margin-bottom: 1rem;">
                        <h5 class="card-title">Conquistadores</h5>
                        <p class="card-text">Gestión del club de Conquistadores</p>
                        <a href="Conquistadores/index.html" class="btn btn-primary">Acceder</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card dashboard-card h-100">
                    <div class="card-body text-center">
                        <img src="img/logo guias.png" alt="Logo Guías Mayores" style="width: 150px; height: 150px; object-fit: contain; margin-bottom: 1rem;">
                        <h5 class="card-title">Guías Mayores</h5>
                        <p class="card-text">Gestión del club de Guías Mayores</p>
                        <a href="Guias/index.html" class="btn btn-primary">Acceder</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card dashboard-card h-100">
            <div class="card-body text-center">
                <img src="ZONA_2.png" alt="Logo Conquistadores" style="width: 150px; height: 150px; object-fit: contain; margin-bottom: 1rem;">
                <h5 class="card-title">Staff</h5>
                <p class="card-text">Gestión Administrativa</p>
                <a href="Staff/index_staff.html" class="btn btn-primary">Acceder</a>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Verificar si el usuario tiene acceso de administrador
        window.onload = function() {
            const currentUser = JSON.parse(sessionStorage.getItem('currentUser'));
            if (!currentUser || currentUser.role !== 'admin') {
                window.location.href = 'index_Login.html';
                return;
            }
            document.getElementById('adminName').textContent = currentUser.username;
            loadUsers();
        };

        function logout() {
            sessionStorage.removeItem('currentUser');
            window.location.href = 'index_Login.html';
        }

        

        // Obtener nombre legible del rol
        function getRoleName(role) {
            const roles = {
                'admin': 'Administrador',
                'dr-aventureros': 'Director de Aventureros',
                'dr-conquistador': 'Director de Conquistadores',
                'dr-guias': 'Director de Guías Mayores'
            };
            return roles[role] || role;
        }

        // Guardar o actualizar usuario
        function saveUser() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const role = document.getElementById('role').value;

            if (!username || !password || !role) {
                alert('Por favor complete todos los campos');
                return;
            }

            let users = JSON.parse(localStorage.getItem('users')) || [];
            const existingUserIndex = users.findIndex(u => u.username === username);

            if (existingUserIndex >= 0) {
                // Actualizar usuario existente
                users[existingUserIndex] = { username, password, role };
            } else {
                // Crear nuevo usuario
                users.push({ username, password, role });
            }

            localStorage.setItem('users', JSON.stringify(users));
            loadUsers();

            // Cerrar modal y limpiar formulario
            const modal = bootstrap.Modal.getInstance(document.getElementById('userModal'));
            modal.hide();
            document.getElementById('userForm').reset();
        }

        // Editar usuario
        function editUser(username) {
            const users = JSON.parse(localStorage.getItem('users')) || [];
            const user = users.find(u => u.username === username);

            if (user) {
                document.getElementById('username').value = user.username;
                document.getElementById('password').value = user.password;
                document.getElementById('role').value = user.role;

                const modal = new bootstrap.Modal(document.getElementById('userModal'));
                modal.show();
            }
        }

        // Eliminar usuario
        function deleteUser(username) {
            if (confirm('¿Está seguro de que desea eliminar este usuario?')) {
                let users = JSON.parse(localStorage.getItem('users')) || [];
                users = users.filter(u => u.username !== username);
                localStorage.setItem('users', JSON.stringify(users));
                loadUsers();
            }
        }
    </script>
</body>
</html>